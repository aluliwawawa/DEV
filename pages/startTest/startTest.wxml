<!--pages/startTest/startTest.wxml-->
<view class="container">
  <!-- 第一个白色容器：进度条 + 问题 + 图片 -->
  <view class="content-container" wx:if="{{questions[currentQuestionIndex]}}">
    <view class="progress-container">
      <t-progress
        theme="plump"
        percentage="{{progressPercentage}}"
      />
    </view>

    <view class="question-text">{{questions[currentQuestionIndex].frage}}</view>

    <view class="image-container" wx:if="{{questions[currentQuestionIndex].image}}">
      <image src="{{questions[currentQuestionIndex].image}}" mode="aspectFit" class="question-image" />
    </view>
  </view>

  <!-- 第二个白色容器：所有选项 -->
  <view class="options-container" wx:if="{{questions[currentQuestionIndex]}}">
    <t-radio-group value="{{currentAnswer}}" bind:change="handleAnswer">
      <t-radio wx:for="{{questions[currentQuestionIndex].auswahl}}"
              wx:key="index"
              value="{{index}}"
              label="{{item}}"
              block />
    </t-radio-group>
  </view>

  <t-dialog
    visible="{{showDialog}}"
    title="{{isCorrect ? '回答正确！' : '回答错误'}}"
    content="{{questions[currentQuestionIndex] ? questions[currentQuestionIndex].erklaerung : ''}}"
    confirm-btn="{{ {content: '继续', variant: 'base' } }}"
    bind:confirm="closeDialog"
    theme="{{isCorrect ? 'success' : 'error'}}"
  >
    <image slot="top" class="dialog-image" src="{{currentImage}}" mode="aspectFit" />
  </t-dialog>

  <view class="completion" wx:if="{{testCompleted}}">
    <t-result
      theme="{{score >= totalQuestions * 0.6 ? 'success' : 'warning'}}"
      title="{{score >= totalQuestions * 0.6 ? '恭喜通过！' : '继续加油！'}}"
      description="测试已完成"
      t-class="result"
    >
      <view slot="action">
        <t-button theme="primary" size="large" bind:tap="viewScore">查看得分</t-button>
      </view>
    </t-result>
  </view>
</view>
